```bash
http {
    # 请求该地址直接返回200（注意：下面的配置可以配置在server或http段或location段）
    server {
        # $内置变量名 当值为空或以0开头的字符串都会被当做false来处理
        # = 是否相等
        # != 是否不相等
        # ~ 正则表达式匹配
        # !~ 非正则表达式匹配
        # ~* 正则表达式匹配，不区分大小写
        # -f 检查文件是否存在
        # !-f 检查文件是否不存在
        # -d 检查目录是否存在
        # !-d 检查目录是否不存在
        # -e 检查文件，目录，符号链接是否存在
        # !-e 检查文件，目录，符号链接是否不存在
        # -x 检查文件是否可执行
        # !-x 检查文件是否不可执行
        # 获取$http_user_agent的值，然后正则表达式匹配里面是否包含Chrome，包含的话执行下面的指令
        if($http_user_agent ~ Chrome) {
            # 将匹配到^(/download/.*)/media/(.*)\..*$的URL重定向到$1/mp3/$2.mp3（注意：$1是第一个正则表达匹配到的内容，$2是第二个正则表达匹配到的内容）
            # 注意：last是重定向类型，重定向类型有如下几种：
            # last 表示重写后的URL会发起新的请求，再次进入server段，重试location中的匹配
            # break  表示直接使用重写后的URL，不再匹配其他location中语句
            # redirect 表示返回302并临时重定向
            # permanent 表示返回301并永久重定向
            rewrite ^(/download/.*)/media/(.*)\..*$ $1/mp3/$2.mp3 last;
            # 最后都没有匹配到就直接返回404
            return  404;
        }
        # 如果客户端的IP是127.0.0.1就直接返回404
        if($remote_addr = "127.0.0.1") {
            return 404 "你迷路了";
        }
    }
}
```
